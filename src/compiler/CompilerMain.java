package compiler;

import parser.Recognizer;

import java.io.PrintWriter;

public class CompilerMain
{
    public static void main(String[] args)
    {

        if (args.length == 0)
        {
            System.out.println("Please enter a file name");
            System.exit(0); //or return? exit runs faster.
        }
        else
        {
            /*Takes an input file from the command line argument and
            stores it in a String called fileName.*/
            String fileName = args[0];
            Recognizer instance = new Recognizer
                    (fileName, true);
            /*Calls Recognizer Object method program. Constructor
            is automatically called when an object of the class is
            created. */
            instance.program();
            /*The symbol table toString generated by passing the file
            into the program method. */
            String tableString = instance.getSymbolTable().toString();
            int dotIndex = fileName.indexOf(".");
            /*The file name from the first letter of the file name up
            to the dot. */
            String baseFileName = fileName.substring(0, dotIndex);
            /*Changing the file extension by adding the file extension
            on to the file name. */
            String fileOutName = baseFileName + ".table";
            try
            {
                PrintWriter printWriter = new PrintWriter(fileOutName);
                //Writing symbol table toString out to the .table file
                printWriter.print(tableString);
                printWriter.close();
            }
            catch (Exception e)
            {
                System.out.println("Failed to write to file");
            }
        }
    }
}
